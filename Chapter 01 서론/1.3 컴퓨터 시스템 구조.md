## 1.3 컴퓨터 시스템 구조

컴퓨터는 사용된 범용 처리기의 개수에 따라 다양하게 분류할 수 있다.



### 1.3.1 단일처리기 시스템

말 그래도 처리기(Processor)가 하나인 시스템이다. 그렇게 때문에 다양하다. 사용자 프로세스의 명령어를 포함하여 범용 명령어 집합을 실행할 수 있는 하나의 주 CPU를 가진다. 단일 처리기 시스템은 범용 CPU를 제외한 특수 목적의 전용 처리기를 가질 수 있다. 이 전용 처리기에는 디스크나 키보드, 그래픽 제어기와 같은 특정 장치 처리기가 있다.

하나의 예로 디스크제어기 마이크로프로세서는 주 CPU로부터 연속된 요청을 받아들여 자기 고유의 디스크 뷰와 스케줄링 알고리즘을 구현한다. 이렇게 되면 주 CPU가 직접 디스크 스케줄을 관리하지 않아도 된다.

### 1.3.1 다중 처리기 시스템

이 시스템은 매우 밀접한 통신을 하는 하나 이상의 처리기들을 가지며, 컴퓨터 버스, 클록, 그리고 때로는 메모리와 주변 장치를 공휴한다. 이러한 다중 처리기 시스템의 세 가지 장점을 살펴보자.

* 증가된 처리량

  처리기의 수를 증가시켰기 때문에 더욱 많은 일을 짧은시간에 할 수 있다. 다만, N개의 처리기를 사용할 경우 속도 증가율은 N배가 되지 않고 N보다 작다. 그 이유는 다수의 처리기가 하나의 테스크를 같이 처리할 경우, 모든 부분이 정확히 동작하도록 하기 위해 약간의 오버헤드가 발생하기 때문이다. 이 오버헤드와 공유자원에 대한 경쟁이 더해져 추가의 처리기를 달아도, 예상보다는 이득이 떨어진다. 간단하게 N명의 프로그래머가 하나의 작업을 실행한다고 해서 속도가 N배가 되진 않는다.(공감.)

* 경제성

  그럼에도 단일 시스템 여러개를 사용하는 대신 다중 처리기 시스템을 사용하는 이유는 비용을 절약할 수 있기 때문인데, 이는 처리기들이 주변의 저장장치, 전원장치 등을 공유하고 있기 때문이다. 

* 증가된 신뢰성

  만약 기능들이 여러개의 처리기에 적절히 분산된다면, 한 처리기가 고장나더라도 시스템은 정지하지 않고, 속도만 느려진다. 만약 10개의 프로세서가 일을 하는데, 하나가 고장난다면 나머지 9개가 고장난 처리기의 작업을 나누어 실행할 수 있다.

  이렇게 한 하드웨어가 고장나도 고장나지 않은 하드웨어의 수준에 비례해 계속 서비스를 제공하는 능력을 **우아한 퇴보**, 또는 **결함 허용적**이라고 불린다.

이렇게 3가지 장점을 보았는데, 결함 허용 시스템은 오류를 탐지하고, 진단하고, 가능하다면 교정할 수 있게하는 기법이 필요하다. 예로 HP사는 오류에도 불구하고 계속 사용 가능하게 하드웨어와 소프트웨어 모두 복제를 사용하고 있다. 이런 시스템은 여러개의 처리기 쌍(2개)으로 구성되고, 한 쌍은 서로 맞물려 동작한다. 이 두쌍은 서로를 판단 하는데, 만약 두개의 처리기가 명령어를 실행하고 나온 결과물이 다르다면, 둘중 하나는 고장난 것이기 때문에 둘다 정지한다. 이때, 실행중이던 프로세스는 다른 CPU쌍으로 이동하고 실패한 명령은 재실행 된다. 하지만 이러한 방법은 비용이 많이 든다.

이러한 방법 외에 가장 널리 사용되는 다중처리기 시스템은 두가지가 있는데, **비대칭적 다중 처리** 와**대칭적 다중 처리** 이다.

비대칭적 다중 처리는 처리기 사이에 주종관계를 정의하여, 주 처리기가 시스템을 제어하고, 나머지 처리기들은 주 처리기의 명령을 실행하거나 미리 정의된 테스크를 실행한다. 보통 주 처리기는 작업을 스케줄하고, 나머지는 작업을 한다.

이보다 일반적인 다중 처리기 시스템인 대칭적 다중 처리이다. 이  방법은 모든 처리기가 대등하여, 각각의 처리기가 자신의 고유 레지스터와 캐시를 가지고 있다. 그러나 모든 처리기는 물리메모리를 공유한다.

이러한 대칭적 다중 처리는 많은 프로세스들이 동시에 실행가능하다는 점이다. 하지만 다중CPU인 만큼 한 CPU만 과하게 부하가 걸려 비효율하게 동작하는 것을 막기 위해 처리기들이 일부 자료구조를 고유시켜 발생하지 않게 할 수 있다.